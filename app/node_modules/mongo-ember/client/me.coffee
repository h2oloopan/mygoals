define [], () ->
	#to use this, make sure Ember-Data and jQuery are already available
	me = 
		version: '{{version}}'
		models: '{{models}}'
		notify: ->
			alert 'Hello World!'
		attach: (App, names) ->
			for name in names
				App[name] = @models[name].model
				App[name + 'Adapter'] = @models[name].adapter
				App[name + 'Serializer'] = @models[name].serializer
			return
		auth:
			signup: (user) ->
				url = '{{url_signup}}'
				data = JSON.stringify
					user: user.toJSON()
				return new Ember.RSVP.Promise (resolve, reject) ->
					$.ajax
						type: 'POST'
						contentType: 'application/json; charset=utf-8'
						url: url
						data: data
						dataType: 'json'
					.done (data) ->
						resolve data
					.fail (data) ->
						reject data.responseText
				#this returns a promise

			login: (user) ->
				url = '{{url_login}}'
				if typeof user.toJSON == 'function' then user = user.toJSON()
				return $.post url,
					user: user
				#this returns a promise
				
			check: ->
				url = '{{url_check}}'
				return new Ember.RSVP.Promise (resolve, reject) ->
					$.get(url).done (data) ->
						resolve data
					.fail (data) ->
						resolve null


			

