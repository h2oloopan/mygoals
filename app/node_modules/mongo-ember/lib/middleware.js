// Generated by CoffeeScript 1.7.1
var createJs, endJs, jses, me, startJs, toSkip;

me = require('./mongo-ember');

jses = {};

toSkip = ['__v'];

startJs = function() {
  var js;
  return js = 'models = {};';
};

endJs = function() {
  var js;
  return js = 'attach = function(App, name) { App[name] = models[name]; App[name + "Adapter"] = adapters[name]; App[name + "Serializer"] = serializers[name]; };';
};

createJs = function(name, schema) {
  var js;
  js = 'models["' + name + '"] = DS.Model.extend({ }); adapters["' + name + '"] = DS.RESTAdapter.extend({' + (me.settings.namespace ? me.settings.namespace : '') + '}); serializers["' + name + '"] = DS.RESTSerializer.extend({ });';
  return js;
};

module.exports = {
  addModel: function(model) {
    var end, key, keys, middle, name, paths, start, _i, _len, _results;
    name = model.modelName;
    paths = model.schema.paths;
    keys = Object.keys(paths);
    _results = [];
    for (_i = 0, _len = keys.length; _i < _len; _i++) {
      key = keys[_i];
      if (toSkip.indexOf(key) >= 0) {
        continue;
      }
      start = startJs();
      middle = createJs(name, paths[key]);
      end = endJs();
      _results.push(jses[name.toLowerCase()] = start + middle + end);
    }
    return _results;
  },
  func: function(req, res, next) {
    return next();
  }
};
