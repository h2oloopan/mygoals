mongoose = require 'mongoose'
mongo = require './mongo'
middleware = require './middleware'


exports.connect = (connectionString) ->
	con = mongoose.connection
	mongoose.connect connectionString,
		server:
			socketOptions:
				keepAlive: 1

	mongoose.connection.on 'connected', ->
		console.log 'MongoDB connected'

	mongoose.connection.on 'disconnected', ->
		console.log 'MongoDB disconnected'

	mongoose.connection.on 'error', (err) ->
		console.log 'MongoDB returned with error ' + err

	return con


exports.middleware = middleware



exports.createModel = (name, schema) ->
	#create the db schema
	mongo.createModel name, schema

	#create the ember schema and bind it to a js api