// Generated by CoffeeScript 1.6.2
define(['views/shared/header'], function(HeaderView) {
  var AccountRouter;

  return AccountRouter = Backbone.Router.extend({
    _view: null,
    _header: null,
    routes: {
      'signup': 'signup',
      'login': 'login',
      'login?from=:from': 'login'
    },
    change: function(view, options) {
      var context;

      if (this._header == null) {
        this._header = new HeaderView();
        this._header.render();
      }
      options = options || {};
      context = this;
      return require([view], function(View) {
        context._view = new View(options);
        return context._view.render();
      });
    },
    signup: function() {
      return this.change('views/account/signup', {
        router: this
      });
    },
    login: function(from) {
      var context;

      context = this;
      return $.get('/api/account/auth').done(function() {
        return window.location.href = '/';
      }).fail(function() {
        if (from != null) {
          return context.change('views/account/login', {
            from: from
          });
        } else {
          return context.change('views/account/login');
        }
      });
    }
  });
});
